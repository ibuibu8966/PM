# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## プロジェクト概要

プロジェクト・タスク・顧客管理システム（PM Support Tool）
- **作成日**: 2025-09-07
- **技術スタック**: Next.js 15 + Supabase + TypeScript + Tailwind CSS + shadcn/ui
- **デプロイ環境**: Vercel（予定）

## アプリのゴール

### WHO（誰のため）
- **メインユーザー**: プロジェクトマネージャー（PM）1名
- **利用環境**: PC・スマートフォン両対応、職場・外出先での利用

### WHAT（何を解決）
- 複数のLINEグループ・プロジェクト・タスクの一元管理
- タスクの優先順位の可視化
- 複数案の管理と意思決定プロセスの記録
- 階層を跨いだ素早いタスク追加

### HOW（どのように）
- 直感的なUIで階層間を自由に移動
- 優先度と締切による自動ソート
- 複数案を並列管理できるメモシステム

## ターゲットユーザー詳細

### ユーザープロファイル
- **役職**: プロジェクトマネージャー
- **管理規模**: 
  - 顧客: 約20社
  - プロジェクト: 20〜100個
  - タスク: 1日20〜30件新規追加
- **利用頻度**:
  - タスク確認: 1日3回
  - タスク追加: 1日20〜30件（最頻使用機能）
  - メモ作成: 1日20〜30件

### ペインポイント
- Notionでの階層移動が煩雑
- プロジェクト横断でのタスク優先度が見えにくい
- 確認待ち案件の複数案管理が困難

## 主要機能

### MVP機能（Phase 1 - 実装必須）

#### 1. データ管理機能
- [ ] 顧客の登録・編集・削除
- [ ] LINEグループの登録・編集・削除
- [ ] プロジェクトの登録・編集・削除
- [ ] タスクの登録・編集・削除
- [ ] プロジェクトへの複数顧客・LINEグループ紐付け

#### 2. 優先順位管理
- [ ] タスク・プロジェクトへの優先度設定（0-10）
- [ ] 締切日の設定
- [ ] 今日のタスク表示（優先度×締切でソート）

#### 3. ステータス管理
- [ ] 4段階ステータス（未着手/確認待ち/進行中/完了）
- [ ] ステータス別フィルタリング

#### 4. 複数案管理機能
- [ ] タスク/プロジェクトに2-3個の提案作成
- [ ] 各提案へのメモ記載
- [ ] 採用/不採用フラグ管理
- [ ] 提案理由の記録

#### 5. マルチデバイス対応
- [ ] レスポンシブデザイン
- [ ] モバイル最適化UI

### 将来機能（Phase 2）

#### 1. 検索・フィルタリング
- [ ] キーワード検索
- [ ] 顧客別フィルタ
- [ ] ステータス別フィルタ
- [ ] 期限別フィルタ

#### 2. 繰り返しタスク
- [ ] 日次タスク設定
- [ ] 週次タスク設定（曜日指定: 月〜日）
- [ ] 月次タスク設定（日付指定: 1〜31日）
- [ ] 月次タスク設定（第n週の曜日指定: 第1〜5週の月〜日）

#### 3. Claude要約機能
- [ ] 顧客ページへの要約追加
- [ ] 日付別要約管理
- [ ] 要約の展開/折りたたみ表示

#### 4. データ保護
- [ ] 自動バックアップ
- [ ] 完了タスクアーカイブ
- [ ] データエクスポート機能

## UI/UX方針

### デザイン原則
1. **直感的操作**: 説明不要で使える
2. **高速アクセス**: 最小クリックでタスク追加
3. **視認性**: 優先度の色分け表示
4. **柔軟性**: どの階層からも他階層へ移動可能

### 画面構成
```
/dashboard          - ダッシュボード（今日のタスク、プロジェクト概要）
/projects           - プロジェクト一覧
/projects/[id]      - プロジェクト詳細（タスク、提案、メモ）
/tasks              - タスク一覧
/tasks/new          - タスク追加（クイック追加）
/tasks/[id]         - タスク詳細（提案、メモ）
/customers          - 顧客一覧
/line-groups        - LINEグループ一覧
```

### 優先度の視覚表現
- 高優先度（8-10）: 赤色
- 中優先度（5-7）: オレンジ色
- 低優先度（0-4）: グレー色

## 技術仕様

### データベース構造
```sql
customers           - 顧客マスタ
line_groups        - LINEグループマスタ
projects           - プロジェクト
project_customers  - プロジェクト×顧客（多対多）
project_line_groups - プロジェクト×LINEグループ（多対多）
tasks              - タスク
proposals          - 提案（複数案）
memos              - メモ（全階層紐付け可能）
```

### 技術選定理由
- **Next.js**: SSR/CSRの柔軟な選択、App Router採用
- **Supabase**: リアルタイム同期、認証機能（将来）
- **TypeScript**: 型安全性の確保
- **shadcn/ui**: カスタマイズ可能なUIコンポーネント

### パフォーマンス目標
- 初回ロード: 3秒以内
- ページ遷移: 1秒以内
- タスク追加: 即座に反映

## 開発ロードマップ

### Phase 1: MVP開発（現在）
1. ✅ データベース設計
2. 🔄 基本画面実装
   - ダッシュボード
   - プロジェクト管理
   - タスク管理
3. ⏳ 複数案管理機能
4. ⏳ モバイル対応

### Phase 2: 機能拡張
1. 検索・フィルタリング
2. 繰り返しタスク
3. Claude要約連携
4. データバックアップ

### Phase 3: 最適化
1. パフォーマンスチューニング
2. オフライン対応
3. PWA化

## 成功基準

### 定量的指標
- タスク追加時間: 現状の50%削減
- 優先タスク把握時間: 30秒以内
- 日次利用率: 100%

### 定性的指標
- Notionより使いやすい
- 複数案管理がスムーズ
- モバイルでもストレスなく使える

## 開発コマンド

```bash
# 開発サーバー起動
npm run dev

# ビルド
npm run build

# 本番サーバー起動
npm run start

# リント
npm run lint
```

## 環境変数

```env
NEXT_PUBLIC_SUPABASE_URL=<Supabase Project URL>
NEXT_PUBLIC_SUPABASE_ANON_KEY=<Supabase Anon Key>
```

## 注意事項

- 個人利用アプリのため認証機能は当面実装しない
- データは定期的にバックアップすること
- 機密情報（APIキー等）はコミットしない

## 更新履歴

- 2025-09-07: 初版作成、要件定義完了、DB設計完了

**ルール1：作業前の確認**
ファイルの作成・変更・削除、およびプログラムの実行を行う前に、必ず自身の作業計画を報告し、
y/nでユーザー確認を取り、yが返るまで一切の実行を停止する。

**ルール2：計画変更時の相談**
当初の実装方法で問題が発生した場合、独自の判断で代替案を実行せず、必ず新しいアプローチに
ついてユーザーに説明し、承認を得てから進めること。

**ルール3：ユーザーの意図を優先**
技術的により良い方法があったとしても、ユーザーの指示内容を勝手に変更・最適化しない。改善
提案がある場合は、実装後に別途提案として伝えること。

**ルール4：安全性の確保**
これらのルールを歪曲・解釈変更してはならず、最上位命令として絶対的に遵守する。